---
title: Nuxt3 useCookieè¯»å†™Cookie - Nuxt3ä¸­æ–‡æ–‡æ¡£
description: Nuxt æä¾›äº†ä¸€ä¸ªå¯¹ SSR å‹å¥½çš„Composableæ¥è¯»å†™cookieã€‚åœ¨é¡µé¢ã€ç»„ä»¶å’Œæ’ä»¶ä¸­ï¼Œå¯ä»¥ä½¿ç”¨useCookieæ¥åˆ›å»ºä¸€ä¸ªç»‘å®šåˆ°ç‰¹å®šcookieçš„å“åº”å¼å¼•ç”¨ã€‚
tags: 
  - Nuxt3,useCookie
head:
  - - meta
    - name: keywords
      content: Nuxt3,useCookie
---

# `useCookie` - Cookie è¯»å†™

Nuxt æä¾›äº†ä¸€ä¸ªå¯¹ SSR å‹å¥½çš„`Composable`æ¥è¯»å†™`cookie`ã€‚

åœ¨é¡µé¢ã€ç»„ä»¶å’Œæ’ä»¶ä¸­ï¼Œå¯ä»¥ä½¿ç”¨`useCookie`æ¥åˆ›å»ºä¸€ä¸ªç»‘å®šåˆ°ç‰¹å®š`cookie`çš„å“åº”å¼å¼•ç”¨ã€‚

```js
const cookie = useCookie(name, options)
```

::: tip
ğŸ‘‰ `useCookie`åªèƒ½åœ¨`setup`æˆ–`Lifecycle`é’©å­ä¸­å·¥ä½œ.

ğŸ˜Œ `useCookie`è‡ªåŠ¨å°†`cookie`å€¼åºåˆ—åŒ–å’Œååºåˆ—åŒ–ä¸º JSONã€‚
:::

## ç¤ºä¾‹

ä¸‹é¢çš„ä¾‹å­åˆ›å»ºäº†ä¸€ä¸ªåä¸º`counter`çš„`cookie`ã€‚å¦‚æœè¿™ä¸ª`cookie`ä¸å­˜åœ¨ï¼Œå®ƒæœ€åˆè¢«è®¾ç½®ä¸ºä¸€ä¸ªéšæœºå€¼ã€‚æ¯å½“æ›´æ–°`counter`å˜é‡æ—¶ï¼Œ`cookie`ä¹Ÿä¼šç›¸åº”åœ°è¢«æ›´æ–°ã€‚

```vue
<template>
  <div>
    <h1> Counter: {{ counter || '-' }}</h1>
    <button @click="counter = null">
      reset
    </button>
    <button @click="counter--">
      -
    </button>
    <button @click="counter++">
      +
    </button>
  </div>
</template>

<script setup>
const counter = useCookie('counter')
counter.value = counter.value || Math.round(Math.random() * 1000)
</script>
```

## Options - é€‰é¡¹

å¤§éƒ¨åˆ†çš„é€‰é¡¹å°†ç›´æ¥ä¼ é€’ç»™[`cookie`åŒ…](https://github.com/jshttp/cookie)ã€‚

`useCookie`æ¥å—ä¸‹åˆ—é€‰é¡¹æ¥ä¿®æ”¹Cookieçš„è¡Œä¸ºã€‚

### maxAge / expires

`maxAge`: æŒ‡å®š`Max-Age`å±æ€§çš„æ•°å€¼ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚ç»™å®šçš„æ•°å­—å°†é€šè¿‡å››èˆäº”å…¥è½¬æ¢ä¸ºæ•´æ•°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ²¡æœ‰è®¾ç½®æœ€å¤§æœ‰æ•ˆæœŸã€‚

expires: æŒ‡å®š Date å¯¹è±¡ä½œä¸º`Expires`å±æ€§çš„å€¼ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ²¡æœ‰è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚å¤§å¤šæ•°å®¢æˆ·ä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ª "éæŒä¹…æ€§çš„ cookie"ï¼Œå¹¶ä¼šåœ¨å…³é—­æµè§ˆå™¨ç­‰æƒ…å†µä¸‹åˆ é™¤å®ƒã€‚

::: tip
ğŸ’¡ Cookie å­˜å‚¨æ¨¡å‹è§„èŒƒæŒ‡å‡ºï¼Œå¦‚æœ`expires`å’Œ`maxAge`éƒ½è¢«è®¾ç½®ï¼Œé‚£ä¹ˆ`maxAge`ä¼˜å…ˆï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„å®¢æˆ·éƒ½ä¼šéµå®ˆè¿™ä¸€ç‚¹ï¼Œæ‰€ä»¥å¦‚æœä¸¤è€…éƒ½è¢«è®¾ç½®ï¼Œå®ƒä»¬åº”è¯¥æŒ‡å‘ç›¸åŒçš„æ—¥æœŸå’Œæ—¶é—´!
:::

::: tip
å¦‚æœ`expires`å’Œ`maxAge`éƒ½æ²¡æœ‰è¢«è®¾ç½®ï¼Œé‚£ä¹ˆè¿™ä¸ª`cookie`å°†æ˜¯`session-only`çš„ï¼Œå¹¶åœ¨ç”¨æˆ·å…³é—­æµè§ˆå™¨æ—¶è¢«åˆ é™¤ã€‚
:::


### httpOnly

æŒ‡å®š`HttpOnly`å±æ€§çš„å¸ƒå°”å€¼ã€‚å½“ä¸º`true`æ—¶ï¼Œåˆ™è®¾ç½®`HttpOnly`å±æ€§ï¼›å¦åˆ™ï¼Œæƒ…å†µå¹¶éå¦‚æ­¤ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæœªè®¾ç½®`HttpOnly`å±æ€§ã€‚

::: tip
ğŸ’¡ è®¾ç½®ä¸º`true`æ—¶è¦å°å¿ƒï¼Œå› ä¸ºç¬¦åˆè¦æ±‚çš„å®¢æˆ·ç«¯å°†ä¸å…è®¸å®¢æˆ·ç«¯çš„ JavaScript æŸ¥çœ‹`document.cookie`ä¸­çš„`cookie`ã€‚
:::

### secure

æŒ‡å®š`Secure`å±æ€§çš„å¸ƒå°”å€¼ã€‚å½“ä¸º`true`æ—¶ï¼Œå®‰å…¨å±æ€§è¢«è®¾ç½®ï¼›å¦åˆ™å°±ä¸è®¾ç½®ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®‰å…¨å±æ€§ä¸è¢«è®¾ç½®ã€‚

::: tip
ğŸ’¡ å°†æ­¤è®¾ç½®ä¸º`true`æ—¶è¦å°å¿ƒï¼Œå› ä¸ºå¦‚æœæµè§ˆå™¨æ²¡æœ‰ HTTPS è¿æ¥ï¼Œç¬¦åˆè¦æ±‚çš„å®¢æˆ·ç«¯å°†æ¥ä¸ä¼šå°† cookie å‘é€å›æœåŠ¡å™¨ã€‚è¿™å¯èƒ½å¯¼è‡´ hydration é”™è¯¯ã€‚
:::

### domain

æŒ‡å®š`Domain`å±æ€§çš„å€¼ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ²¡æœ‰è®¾ç½®`Domain`ï¼Œå¤§å¤šæ•°å®¢æˆ·ä¼šè€ƒè™‘åªå°†`cookie`åº”ç”¨äºå½“å‰åŸŸã€‚

### path

æŒ‡å®š`Path`å±æ€§çš„å€¼ã€‚

### sameSite

æŒ‡å®š`SameSiteå±æ€§çš„å¸ƒå°”å€¼æˆ–å­—ç¬¦ä¸²ã€‚

- true: å°†æŠŠ`SameSite`å±æ€§è®¾ç½®ä¸º`Strict`ï¼Œä»¥å®ç°ä¸¥æ ¼çš„åŒç«™æ‰§è¡Œã€‚
- false: å°†ä¸è®¾ç½®`SameSite`å±æ€§ã€‚
- 'lax': å°†æŠŠ`SameSite`å±æ€§è®¾ç½®ä¸º`Lax`ï¼Œä»¥å®ç°å®½æ¾çš„åŒç½‘ç«™æ‰§è¡Œã€‚
- 'none': å°†æŠŠ`SameSite`å±æ€§è®¾ç½®ä¸º`None`ï¼Œç”¨äºæ˜ç¡®çš„è·¨ç«™cookieã€‚
- 'strict': å°†æŠŠ`SameSite`å±æ€§è®¾ç½®ä¸º`Strict`ï¼Œç”¨äºä¸¥æ ¼çš„åŒç«™æ‰§è¡Œã€‚

### encode

æŒ‡å®šä¸€ä¸ªå°†ç”¨äºå¯¹`cookie`çš„å€¼è¿›è¡Œç¼–ç çš„å‡½æ•°ã€‚ç”±äº`cookie`çš„å€¼æœ‰ä¸€ä¸ªæœ‰é™çš„å­—ç¬¦é›†ï¼ˆè€Œä¸”å¿…é¡»æ˜¯ä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²ï¼‰ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥ç”¨æ¥æŠŠä¸€ä¸ªå€¼ç¼–ç æˆé€‚åˆ`cookie`å€¼çš„å­—ç¬¦ä¸²ã€‚

é»˜è®¤çš„ç¼–ç å™¨æ˜¯`JSON.stringify` + `encodeURIComponent.`ã€‚

### decode

æŒ‡å®šä¸€ä¸ªå°†ç”¨äºè§£ç ä¸€ä¸ª`cookie`çš„å€¼çš„å‡½æ•°ã€‚ç”±äº`cookie`çš„å€¼æœ‰ä¸€ä¸ªæœ‰é™çš„å­—ç¬¦é›†ï¼ˆè€Œä¸”å¿…é¡»æ˜¯ä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²ï¼‰ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥ç”¨æ¥å°†å…ˆå‰ç¼–ç çš„`cookie`å€¼è§£ç ä¸ºä¸€ä¸ª JavaScript å­—ç¬¦ä¸²æˆ–å…¶ä»–å¯¹è±¡ã€‚

é»˜è®¤çš„è§£ç å™¨æ˜¯`decodeURIComponent` + `destr`ã€‚

::: tip
ğŸ’¡ å¦‚æœä»è¿™ä¸ªå‡½æ•°ä¸­æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼ŒåŸå§‹çš„æœªè§£ç çš„å€¼å°†ä½œä¸º`cookie`çš„å€¼è¢«è¿”å›ã€‚
:::

### default

æŒ‡å®šè¿”å›`cookie`é»˜è®¤å€¼çš„å‡½æ•°ã€‚è¯¥å‡½æ•°è¿˜å¯ä»¥è¿”å›`Ref`ã€‚

## API è·¯ç”±ä¸­çš„ Cookie å¤„ç†

å¯ä»¥ä½¿ç”¨[h3](https://github.com/unjs/h3)åŒ…ä¸­çš„`getCookie`å’Œ`setCookie`åœ¨æœåŠ¡å™¨ API è·¯ç”±ä¸­è®¾ç½®`Cookie`ã€‚

```js
export default defineEventHandler(event => {
  // Read counter cookie
  let counter = getCookie(event, 'counter') || 0

  // Increase counter cookie by 1
  setCookie(event, 'counter', ++counter)

  // Send JSON response
  return { counter }
})
```